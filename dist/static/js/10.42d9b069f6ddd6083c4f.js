webpackJsonp([10],{527:function(e,t,a){a(898),a(900);var r=a(203)(a(902),a(908),"data-v-689752a0",null);e.exports=r.exports},898:function(e,t,a){var r=a(899);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(205)("e996003a",r,!0)},899:function(e,t,a){t=e.exports=a(204)(!1),t.push([e.i,".crumbs[data-v-689752a0]{margin-bottom:0;margin-top:10px}.demo-table-expand[data-v-689752a0]{font-size:0}.demo-table-expand label[data-v-689752a0]{width:90px;color:#99a9bf}.demo-table-expand .el-form-item[data-v-689752a0]{margin-right:0;margin-bottom:0;width:33%}.rad-group[data-v-689752a0]{margin-bottom:20px}.handle-input[data-v-689752a0]{width:300px;display:inline-block}.handle-box2[data-v-689752a0]{display:inline-block;float:right}.pagecont[data-v-689752a0]{margin-top:30px}",""])},900:function(e,t,a){var r=a(901);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(205)("236a3fa1",r,!0)},901:function(e,t,a){t=e.exports=a(204)(!1),t.push([e.i,".diagcontpush{min-width:850px}",""])},902:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(903),i=a.n(r);t.default={data:function(){return{curRadio:"firmware",search_word:"",listData:[],pageTotal:0,currentPage:1,loading:!0,dialogUpdataVisible:!1,typeListData:[]}},created:function(){this.getParams(),this.getFirmwarePushTaskList({}),this.getTypes()},components:{setpushnew:i.a},methods:{thenPushEvent:function(e){var t=this;"cancle"==e?t.dialogUpdataVisible=!1:"firmware"==e?(t.curRadio="firmware",t.getFirmwarePushTaskList({})):"apps"==e?(t.curRadio="apps",t.getAppsPushTaskList({})):"script"==e&&(t.curRadio="script",t.getScriptPushTaskList({})),t.dialogUpdataVisible=!1},getParams:function(){var e=this;e.curRadio=e.$route.query.curRadio||"firmware";var t="0"==localStorage.getItem("userMsg")?"":localStorage.getItem("ms_username"),a=""==t?{}:{filter:{user_name:t}};"firmware"==e.curRadio&&e.getFirmwarePushTaskList(a),"apps"==e.curRadio&&e.getAppsPushTaskList({}),"script"==e.curRadio&&e.getScriptPushTaskList({})},getTypes:function(){var e=this;e.$axios.post("/api/devtype/types").then(function(t){"1001"==t.data.ret_code&&(e.$message({message:t.data.extra,type:"warning"}),setTimeout(function(){e.$router.replace("login")},2e3)),0==t.data.ret_code&&(e.typeListData=t.data.extra)})},getFirmwarePushTaskList:function(e){var t=this;t.$axios.post("/api/rom/task/list/sysupgrade",e).then(function(e){t.loading=!1,"1001"==e.data.ret_code&&(t.$message({message:e.data.extra,type:"warning"}),setTimeout(function(){t.$router.replace("login")},2e3)),0==e.data.ret_code?(t.pageTotal=e.data.extra.count||t.pageTotal,t.listData=e.data.extra.resultList):t.$message.error(e.data.extra)},function(e){t.loading=!1,console.log(e)})},getAppsPushTaskList:function(e){var t=this;t.$axios.post("/api/apps/task/apps_result",e).then(function(e){t.loading=!1,"1001"==e.data.ret_code&&(t.$message({message:e.data.extra,type:"warning"}),setTimeout(function(){t.$router.replace("login")},2e3)),0==e.data.ret_code?(t.pageTotal=e.data.extra.count||t.pageTotal,t.listData=e.data.extra.apps_task):t.$message.error(e.data.extra)},function(e){t.loading=!1,console.log(e)})},getScriptPushTaskList:function(e){var t=this;t.$axios.post("/api/apps/task/script_result",e).then(function(e){t.loading=!1,"1001"==e.data.ret_code&&(t.$message({message:e.data.extra,type:"warning"}),setTimeout(function(){t.$router.replace("login")},2e3)),0==e.data.ret_code?(t.pageTotal=e.data.extra.count||t.pageTotal,t.listData=e.data.extra.script_task):t.$message.error(e.data.extra)},function(e){t.loading=!1,console.log(e)})},changeTab:function(){var e=this;e.currentPage=1,"firmware"==e.curRadio&&e.getFirmwarePushTaskList({}),"apps"==e.curRadio&&e.getAppsPushTaskList({}),"script"==e.curRadio&&e.getScriptPushTaskList({})},handleCurrentChange:function(e){var t=this;t.currentPage=e;var a={page_size:10,current_page:this.currentPage};if(""!=t.search_word){if(!t.validateSearchWord(t.search_word))return!1;var r={mac:(t.search_word.indexOf(":")>=0?t.search_word.replace(/:/g,""):t.search_word).toUpperCase()};a.filter=r}"firmware"==t.curRadio&&t.getFirmwarePushTaskList(a),"apps"==t.curRadio&&t.getAppsPushTaskList(a),"script"==t.curRadio&&t.getScriptPushTaskList(a)},validateSearchWord:function(e){var t=this,a=/^[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}$/,r=/^[A-Fa-f\d]{2}[A-Fa-f\d]{2}[A-Fa-f\d]{2}[A-Fa-f\d]{2}[A-Fa-f\d]{2}[A-Fa-f\d]{2}$/;return""==e?(t.$message({message:"输入不能为空",type:"warning"}),!1):!(!a.test(e)&&!r.test(e))||(t.$message({message:"设备MAC输入有误",type:"warning"}),!1)},search:function(){var e=this;if(e.currentPage=1,!e.validateSearchWord(e.search_word))return!1;e.loading=!0;var t=e.search_word,a=(t.indexOf(":")>=0?t.replace(/:/g,""):t).toUpperCase(),r={filter:{mac:a}},i="firmware"==e.curRadio?"/api/rom/task/list/sysupgrade":"apps"==e.curRadio?"/api/apps/apps_query":"/api/apps/script_query";e.$axios.post(i,r).then(function(t){e.loading=!1,"1001"==t.data.ret_code&&(e.$message({message:t.data.extra,type:"warning"}),setTimeout(function(){e.$router.replace("login")},2e3)),0==t.data.ret_code&&(e.pageTotal=t.data.extra.length,e.listData=t.data.extra.slice(0,10))})},goDetail:function(e){this.$router.push({path:"/pushresultdetail",query:{curid:e,curRadio:this.curRadio}})}}}},903:function(e,t,a){a(904);var r=a(203)(a(906),a(907),null,null);e.exports=r.exports},904:function(e,t,a){var r=a(905);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(205)("676b348d",r,!0)},905:function(e,t,a){t=e.exports=a(204)(!1),t.push([e.i,".mb40{margin-bottom:40px}.tab-cont{padding:40px}.diainp{width:217px}.diainp2{width:550px}.inp100{width:100px}.form-box2{width:750px}.daorubtn{vertical-align:top;display:inline-block}",""])},906:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{form0:{router_mac:"",dev_type:"",dest_version:"",firmware_file:"",firmware_md5:"",upgrade_mode:"1",upgrade_time:"0:00",reflash:"0",operator_name:"",expired_time:"0",isTime:!0},romListDataPre:[],romListData:[],isValidTime0:!1,upgradeTime:["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],rules0:{router_mac:[{required:!0,message:"请输入指定MAC",trigger:"blur"},{validator:this.validateMac,trigger:"blur"}],dev_type:[{required:!0,message:"请选择设备型号",trigger:"change"}],dest_version:[{required:!0,message:"请选择ROM版本",trigger:"change"}],upgrade_mode:[{required:!0,message:"请选择升级方式",trigger:"change"}],reflash:[{required:!0,message:"请选择配置更新",trigger:"change"}],expired_time:[{required:!0,message:"请输入超时时间",trigger:"blur"},{validator:this.validateTimeNum,trigger:"blur"}],operator_name:[{required:!0,message:"请输入操作人",trigger:"blur"},{validator:this.validateSpace,trigger:"blur"}]},form1:{route_mac:"",pkg_name:"",pkg_str_name:"",pkg_version:"",pkg_mode:"1",exec_time:"0:00",expired_time:"0",isTime:!0,operator:""},pluginListData:[],pVerlist:[],isValidTime1:!1,rules1:{route_mac:[{required:!0,message:"请输入MAC",trigger:"blur"},{validator:this.validateMac,trigger:"blur"}],pkg_name:[{required:!0,message:"请选择要安装的插件",trigger:"change"}],pkg_version:[{required:!0,message:"请选择插件的版本",trigger:"change"}],pkg_mode:[{required:!0,message:"请选择升级方式",trigger:"change"}],expired_time:[{required:!0,message:"请输入超时时间",trigger:"blur"},{validator:this.validateTimeNum,trigger:"blur"}]},form2:{route_mac:"",script_name:"",script_mode:"1",exec_time:"0:00",expired_time:"0",isTime:!0,operator:""},scriptListData:[],isValidTime2:!1,rules2:{route_mac:[{required:!0,message:"请输入MAC",trigger:"blur"},{validator:this.validateMac,trigger:"blur"}],script_name:[{required:!0,message:"请选择要安装的脚本",trigger:"change"}],script_mode:[{required:!0,message:"请选择升级方式",trigger:"change"}],expired_time:[{required:!0,message:"请输入超时时间",trigger:"blur"},{validator:this.validateTimeNum,trigger:"blur"}]},task_type:"1",value:"",romtest:[],filetest:"",loading:!1,fileList0:[],fileForm0:{},fileList1:[],fileList2:[]}},props:{typeListData:{type:Array,required:!0}},created:function(){this.getRomList(),this.getAppsData()},methods:{onRomSubmit:function(e){var t=this;t.$refs[e].validate(function(e){if(!e)return!1;var a=t.form0.router_mac,r={route_mac:(a.indexOf(":")>=0?a.replace(/:/g,""):a).toUpperCase(),operator_name:t.form0.operator_name,dev_type:t.form0.dev_type,dest_version:t.form0.dest_version,firmware_file:t.form0.firmware_file,firmware_md5:t.form0.firmware_md5,upgrade_mode:t.form0.upgrade_mode,upgrade_time:t.form0.upgrade_time,reflash:t.form0.reflash,expired_time:t.form0.expired_time};t.loading=!0,t.$axios.post("/api/rom/task/add/sysupgrade",r).then(function(e){t.loading=!1,"1001"==e.data.ret_code&&(t.$message({message:e.data.extra,type:"warning"}),setTimeout(function(){t.$router.replace("login")},2e3)),0==e.data.ret_code?(t.$message({message:"推送成功",type:"success"}),t.$emit("listenPushEvent","firmware")):t.$message.error(e.data.extra),t.form0.router_mac="",t.form0.dev_type="",t.form0.dest_version="",t.form0.firmware_file="",t.form0.firmware_md5="",t.form0.upgrade_mode="1",t.form0.upgrade_time="",t.form0.reflash="0",t.form0.operator_name="",t.form0.expired_time="0"})})},onPluginSubmit:function(e){var t=this;t.$refs[e].validate(function(e){if(!e)return!1;for(var a,r=t.pluginListData,i=0;i<r.length;i++)if(r[i].pkg_name==t.form1.pkg_name){a=r[i];break}var o=t.form1.router_mac,s={route_mac:(o.indexOf(":")>=0?o.replace(/:/g,""):o).toUpperCase(),pkg_name:t.form1.pkg_name,pkg_str_name:a.pkg_str_name,pkg_version:a.pkg_version,pkg_mode:t.form1.pkg_mode,exec_time:t.form1.exec_time,expired_time:t.form1.expired_time,operator:t.form1.operator};t.loading=!0,t.$axios.post("/api/apps/task/install",s).then(function(e){t.loading=!1,0==e.data.ret_code?(t.$message({message:e.data.extra,type:"success"}),t.$emit("listenPushEvent","apps")):t.$message.error(e.data.extra),t.form1.route_mac="",t.form1.pkg_str_name="",t.form1.pkg_version="",t.form1.pkg_mode="1",t.form1.upgrade_time="",t.form1.expired_time="0",t.form1.isTime=!0,t.form1.operator=""})})},onScriptSubmit:function(e){var t=this;t.$refs[e].validate(function(e){if(!e)return!1;var a=t.form2.router_mac,r={route_mac:(a.indexOf(":")>=0?a.replace(/:/g,""):a).toUpperCase(),script_name:t.form2.script_name,script_mode:t.form2.script_mode,exec_time:t.form2.exec_time,expired_time:t.form2.expired_time,operator:t.form2.operator};t.loading=!0,t.$axios.post("/api/apps/script",r).then(function(e){t.loading=!1,"1001"==e.data.ret_code&&(t.$message({message:e.data.extra,type:"warning"}),setTimeout(function(){t.$router.replace("login")},2e3)),0==e.data.ret_code?(t.$message({message:e.data.extra,type:"success"}),t.$emit("listenPushEvent","script")):t.$message.error(e.data.extra),t.form2.route_mac="",t.form2.script_name="",t.form2.script_mode="1",t.form2.upgrade_time="",t.form2.expired_time="0",t.form2.isTime=!0,t.form2.operator=""})})},beforeUpload:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),a="xls"===t,r="xlsx"===t,i="doc"===t,o="docx"===t,s=e.size/1024/1024<10;return a||r||i||o?s?void 0:(this.$message({message:"上传模板大小不能超过 10MB!",type:"warning"}),!1):(this.$message({message:"上传模板只能是 xls格式!",type:"warning"}),!1)},beforeUpload1:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),a="xls"===t,r="xlsx"===t,i="doc"===t,o="docx"===t,s=e.size/1024/1024<10;return a||r||i||o?s?void 0:(this.$message({message:"上传模板大小不能超过 10MB!",type:"warning"}),!1):(this.$message({message:"上传模板只能是 xls格式!",type:"warning"}),!1)},handleSuccess:function(e,t,a){console.log("1",e,t,a);var r=this;0==e.ret_code?(r.form0.router_mac=e.extra.join(","),r.fileList0=[]):this.$message.error(e.extra)},handleSuccess1:function(e,t,a){console.log("2",e,t,a);var r=this;0==e.ret_code?(r.form1.route_mac=e.extra.join(","),r.fileList1=[]):this.$message.error(e.extra)},handleSuccess2:function(e,t,a){var r=this;0==e.ret_code?(r.form2.route_mac=e.extra.join(","),r.fileList2=[]):this.$message.error(e.extra)},handleError:function(e,t,a){this.$message.error("操作失败")},handleChange:function(e){this.$refs.upload.submit()},handleChange1:function(e){this.$refs.upload.submit()},handleChange2:function(e){this.$refs.upload.submit()},getRomList:function(){var e=this;e.$axios.post("/api/rom/list").then(function(t){"1001"==t.data.ret_code&&(e.$message({message:t.data.ret_msg,type:"warning"}),setTimeout(function(){e.$router.replace("login")},2e3)),0==t.data.ret_code&&(e.romListDataPre=t.data.extra)})},getAppsData:function(e){var t=this;t.$axios.post("/api/apps/list",e).then(function(e){t.loading=!1,0==e.data.ret_code?t.pluginListData=e.data.extra:t.$message.error(e.data.extra)},function(e){t.loading=!1,console.log(e)})},getScriptData:function(e){var t=this;t.$axios.post("/api/script/list",e).then(function(a){t.loading=!1,"1001"==a.data.ret_code&&(t.$message({message:a.data.extra,type:"warning"}),setTimeout(function(){t.$router.replace("login")},2e3)),0==a.data.ret_code?"{}"==JSON.stringify(e)?(t.pageTotal=a.data.extra.length,t.listData3=a.data.extra.slice(0,10)):t.listData3=a.data.extra:t.$message.error(a.data.extra)},function(e){t.loading=!1,console.log(e)})},changeDev:function(){var e=this;e.form0.dest_version="",e.form0.firmware_file="",e.form0.firmware_md5="";for(var t=e.form0.dev_type,a=[],r=e.romListDataPre,i=0;i<r.length;i++)r[i].dev_type==t&&a.push(r[i]);e.romListData=a,a.length&&(e.form0.dest_version=a[0].rom_version||"",e.form0.firmware_file=a[0].file_name||"",e.form0.firmware_md5=a[0].md5_value||"")},changeRom:function(){for(var e=this,t=e.form0.dest_version,a=e.romListDataPre,r=0;r<a.length;r++)a[r].dev_type==e.form0.dev_type&&a[r].rom_version==t&&(e.form0.firmware_file=a[r].file_name,e.form0.firmware_md5=a[r].md5_value)},changeUpgrade:function(e){"1"==e?(this.form0.expired_time="0",this.form0.isTime=!0):(this.form0.expired_time="",this.form0.isTime=!1),this.isValidTime0="3"==e},handleClick:function(e,t){e.name,e.name,e.name},validateSpace:function(e,t,a){t.indexOf(" ")>=0?a(new Error("输入有空格")):a()},validateTimeNum:function(e,t,a){var r=this,i=/^\d+$/;i.test(t)||a(new Error("输入必须是数字")),("1"==r.task_type&&r.isValidTime0||"2"==r.task_type&&r.isValidTime1||"3"==r.task_type&&r.isValidTime2)&&(!i.test(t)||Number(t)<24)?a(new Error("输入必须是数字,且不小于24")):a()},validateMac:function(e,t,a){var r=this,i=r.splitStr(t);i.length},splitStr:function(e){for(var t=e.split(/[\n,]/g),a=0;a<t.length;a++)""==t[a]&&(t.splice(a,1),a--);return t},changePlugin:function(){for(var e=this,t=(e.form1.pkg_str_name,[]),a=e.pluginListData,r=0;r<a.length;r++)a[r].pkg_str_name==e.form1.pkg_str_name&&t.push(a[r]);e.pVerlist=t,t.length&&(e.form1.pkg_version=t[0].pkg_version||"")},changePkgMode:function(e){"1"==e?(this.form1.expired_time="0",this.form1.isTime=!0):(this.form1.expired_time="",this.form1.isTime=!1),this.isValidTime1="3"==e},changeScriptMode:function(e){"1"==e?(this.form2.expired_time="0",this.form2.isTime=!0):(this.form2.expired_time="",this.form2.isTime=!1),this.isValidTime2="3"==e}}}},907:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("div",{staticClass:"rad-group mb40"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.task_type,callback:function(t){e.task_type=t},expression:"task_type"}},[a("el-tab-pane",{attrs:{label:"升级ROM",name:"1"}},[a("div",{staticClass:"form-box tab-cont form-box2"},[a("el-form",{ref:"form0",attrs:{model:e.form0,rules:e.rules0,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"选择设备型号",prop:"dev_type"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeDev},model:{value:e.form0.dev_type,callback:function(t){e.$set(e.form0,"dev_type",t)},expression:"form0.dev_type"}},e._l(e.typeListData,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"选择ROM版本",prop:"dest_version"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeRom},model:{value:e.form0.dest_version,callback:function(t){e.$set(e.form0,"dest_version",t)},expression:"form0.dest_version"}},e._l(e.romListData,function(e){return a("el-option",{key:e.rom_version,attrs:{label:e.rom_version,value:e.rom_version}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"所选文件"}},[a("el-input",{staticClass:"diainp2",attrs:{disabled:!0},model:{value:e.form0.firmware_file,callback:function(t){e.$set(e.form0,"firmware_file",t)},expression:"form0.firmware_file"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"输入指定MAC",prop:"router_mac"}},[a("el-input",{staticClass:"diainp2",attrs:{type:"textarea",placeholder:"以换行符分割"},model:{value:e.form0.router_mac,callback:function(t){e.$set(e.form0,"router_mac",t)},expression:"form0.router_mac"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"升级方式",prop:"upgrade_mode",inline:!0}},[a("el-radio-group",{attrs:{inline:!0},on:{change:e.changeUpgrade},model:{value:e.form0.upgrade_mode,callback:function(t){e.$set(e.form0,"upgrade_mode",t)},expression:"form0.upgrade_mode"}},[a("el-radio",{attrs:{label:"1"}},[e._v("实时自动升级")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("定时自动升级(整点时刻)")])],1),e._v(" "),"3"==e.form0.upgrade_mode?a("el-select",{staticStyle:{width:"100px"},attrs:{inline:!0,placeholder:"0"},model:{value:e.form0.upgrade_time,callback:function(t){e.$set(e.form0,"upgrade_time",t)},expression:"form0.upgrade_time"}},e._l(e.upgradeTime,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"配置更新",prop:"reflash"}},[a("el-radio-group",{model:{value:e.form0.reflash,callback:function(t){e.$set(e.form0,"reflash",t)},expression:"form0.reflash"}},[a("el-radio",{attrs:{label:"0"}},[e._v("保留用户原有配置")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("更改用户原有配置(慎选)")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"超时时间",prop:"expired_time"}},[a("el-input",{staticClass:"inp100",attrs:{disabled:e.form0.isTime},model:{value:e.form0.expired_time,callback:function(t){e.$set(e.form0,"expired_time",t)},expression:"form0.expired_time"}}),e._v(" "),a("a",[e._v(" 小时")])],1),e._v(" "),a("el-form-item",{attrs:{label:"操作人",prop:"operator_name"}},[a("el-input",{staticClass:"diainp",model:{value:e.form0.operator_name,callback:function(t){e.$set(e.form0,"operator_name",t)},expression:"form0.operator_name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onRomSubmit("form0")}}},[e._v("执行")])],1)],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"安装插件",name:"2"}},[a("div",{staticClass:"form-box tab-cont form-box2"},[a("el-form",{ref:"form1",attrs:{model:e.form1,rules:e.rules1,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"输入指定MAC",prop:"route_mac"}},[a("el-input",{staticClass:"textarea-mac diainp2",attrs:{type:"textarea",placeholder:"以换行符分割"},model:{value:e.form1.route_mac,callback:function(t){e.$set(e.form1,"route_mac",t)},expression:"form1.route_mac"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择要安装的插件",prop:"pkg_name"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changePlugin},model:{value:e.form1.pkg_name,callback:function(t){e.$set(e.form1,"pkg_name",t)},expression:"form1.pkg_name"}},e._l(e.pluginListData,function(e){return a("el-option",{key:e.pkg_name,attrs:{label:e.pkg_name,value:e.pkg_name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"升级方式",prop:"pkg_mode",inline:!0}},[a("el-radio-group",{attrs:{inline:!0},on:{change:e.changePkgMode},model:{value:e.form1.pkg_mode,callback:function(t){e.$set(e.form1,"pkg_mode",t)},expression:"form1.pkg_mode"}},[a("el-radio",{attrs:{label:"1"}},[e._v("实时自动升级")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("定时自动升级(整点时刻)")])],1),e._v(" "),"3"==e.form1.pkg_mode?a("el-select",{staticStyle:{width:"100px"},attrs:{inline:!0,placeholder:"0"},model:{value:e.form1.exec_time,callback:function(t){e.$set(e.form1,"exec_time",t)},expression:"form1.exec_time"}},e._l(e.upgradeTime,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"超时时间",prop:"expired_time"}},[a("el-input",{staticClass:"inp100",attrs:{disabled:e.form1.isTime},model:{value:e.form1.expired_time,callback:function(t){e.$set(e.form1,"expired_time",t)},expression:"form1.expired_time"}}),e._v(" "),a("a",[e._v(" 小时")])],1),e._v(" "),a("el-form-item",{attrs:{label:"操作人",prop:"operator"}},[a("el-input",{staticClass:"diainp",model:{value:e.form1.operator,callback:function(t){e.$set(e.form1,"operator",t)},expression:"form1.operator"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onPluginSubmit("form1")}}},[e._v("安装")])],1)],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"推送脚本",name:"3"}},[a("div",{staticClass:"form-box tab-cont form-box2"},[a("el-form",{ref:"form2",attrs:{model:e.form2,rules:e.rules2,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"输入指定MAC",prop:"route_mac"}},[a("el-input",{staticClass:"textarea-mac diainp2",attrs:{type:"textarea",placeholder:"以换行符分割"},model:{value:e.form2.route_mac,callback:function(t){e.$set(e.form2,"route_mac",t)},expression:"form2.route_mac"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择要安装的脚本",prop:"script_name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form2.script_name,callback:function(t){e.$set(e.form2,"script_name",t)},expression:"form2.script_name"}},e._l(e.scriptListData,function(e){return a("el-option",{key:e.script_name,attrs:{label:e.script_name,value:e.script_name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"升级方式",prop:"script_mode",inline:!0}},[a("el-radio-group",{attrs:{inline:!0},on:{change:e.changeScriptMode},model:{value:e.form2.script_mode,callback:function(t){e.$set(e.form2,"script_mode",t)},expression:"form2.script_mode"}},[a("el-radio",{attrs:{label:"1"}},[e._v("实时自动升级")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("定时自动升级(整点时刻)")])],1),e._v(" "),"3"==e.form2.script_mode?a("el-select",{staticStyle:{width:"100px"},attrs:{inline:!0,placeholder:"0"},model:{value:e.form2.exec_time,callback:function(t){e.$set(e.form2,"exec_time",t)},expression:"form2.exec_time"}},e._l(e.upgradeTime,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"超时时间",prop:"expired_time"}},[a("el-input",{staticClass:"inp100",attrs:{disabled:e.form2.isTime},model:{value:e.form2.expired_time,callback:function(t){e.$set(e.form2,"expired_time",t)},expression:"form2.expired_time"}}),e._v(" "),a("a",[e._v(" 小时")])],1),e._v(" "),a("el-form-item",{attrs:{label:"操作人",prop:"operator"}},[a("el-input",{staticClass:"diainp",model:{value:e.form2.operator,callback:function(t){e.$set(e.form2,"operator",t)},expression:"form2.operator"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onScriptSubmit("form2")}}},[e._v("安装")])],1)],1)],1)])],1)],1)])},staticRenderFns:[]}},908:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticStyle:{overflow:"hidden"}},[a("el-form",{staticClass:"handle-box2",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"请输入设备MAC"},model:{value:e.search_word,callback:function(t){e.search_word=t},expression:"search_word"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("hr",{staticStyle:{border:"none","border-top":"1px solid #efefef","margin-top":"10px","margin-bottom":"20px"}}),e._v(" "),a("div",{staticClass:"rad-group"},[a("el-radio-group",{on:{change:e.changeTab},model:{value:e.curRadio,callback:function(t){e.curRadio=t},expression:"curRadio"}},[a("el-radio-button",{attrs:{label:"firmware"}},[e._v("ROM升级")]),e._v(" "),a("el-radio-button",{attrs:{label:"apps"}},[e._v("插件升级")]),e._v(" "),a("el-radio-button",{attrs:{label:"script"}},[e._v("脚本推送")])],1),e._v(" "),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"icon iconfont icon-zhifeiji",type:"primary"},on:{click:function(t){e.dialogUpdataVisible=!0}}},[e._v("升级设备")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.listData,border:""}},[a("el-table-column",{attrs:{prop:"request_msg",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"primary"}},[e._v(e._s("firmware"==e.curRadio?"ROM升级":"apps"==e.curRadio?"插件升级":"脚本升级"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"request_timestamp",sortable:"",label:"时间",width:"170"}}),e._v(" "),a("el-table-column",{attrs:{prop:"_id",label:"任务ID",width:"320"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mac",label:"指定MAC",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.mac.length>1?t.row.mac[0]+"···":t.row.mac.toString()))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"upgrade_mode",label:"升级方式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"1"==t.row.upgrade_mode?"warning":"2"==t.row.upgrade_mode?"success":"primary","close-transition":""}},[e._v(e._s("1"==t.row.upgrade_mode?"实时自动":"2"==t.row.upgrade_mode?"用户自动":"定时自动"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"结果",width:"150"}},[a("el-table-column",{attrs:{prop:"success_count",label:"成功"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.success_count))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fail_count",label:"失败"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.fail_count))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"running_count",label:"执行中"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.row.running_count))])]}}])})],1),e._v(" "),a("el-table-column",{attrs:{prop:"operator_name",label:"操作人",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"详情"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn1",attrs:{type:"info",size:"small"},on:{click:function(a){e.goDetail(t.row._id)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,layout:"prev, pager, next",total:e.pageTotal},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"升级设备",visible:e.dialogUpdataVisible,"custom-class":"diagcontpush"},on:{"update:visible":function(t){e.dialogUpdataVisible=t}}},[a("div",[a("setpushnew",{attrs:{typeListData:e.typeListData},on:{listenPushEvent:e.thenPushEvent}})],1)])],1)},staticRenderFns:[]}}});